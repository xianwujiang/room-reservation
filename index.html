<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>会议室预约系统</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; background: #f8f9fa; }
    h1 { text-align: center; color: #333; }
    .container { max-width: 800px; margin: auto; background: #fff; padding: 20px; border-radius: 12px; box-shadow: 0 4px 10px rgba(0,0,0,0.1);}
    label { display: block; margin-top: 10px; font-weight: bold; }
    select, input { width: 100%; padding: 8px; margin-top: 5px; border-radius: 6px; border: 1px solid #ccc; }
    button { margin-top: 15px; padding: 10px 20px; border: none; border-radius: 6px; background: #007bff; color: #fff; cursor: pointer; }
    button:hover { background: #0056b3; }
    .list { margin-top: 20px; }
    .item { background: #f1f1f1; margin: 10px 0; padding: 10px; border-radius: 8px; display: flex; justify-content: space-between; align-items: center;}
    .admin-controls button { margin-left: 5px; background: #28a745; }
    .admin-controls button.delete { background: #dc3545; }
  </style>
</head>
<body>
  <div class="container">
    <h1>会议室预约系统</h1>
    <label>姓名：</label>
    <input type="text" id="name"/>

    <label>选择会议室：</label>
    <select id="room">
      <option value="物理楼304">物理楼304</option>
      <option value="物理楼307">物理楼307</option>
      <option value="学院楼304">学院楼304（需管理员审核）</option>
    </select>

    <label>开始时间：</label>
    <input type="time" id="startTime"/>

    <label>结束时间：</label>
    <input type="time" id="endTime"/>

    <button onclick="makeReservation()">提交预约</button>

    <hr/>
    <label>管理员邮箱：</label>
    <input type="email" id="adminEmail"/>
    <label>管理员密码：</label>
    <input type="password" id="adminPassword"/>
    <button onclick="toggleAdmin()">切换管理员模式</button>

    <div class="list" id="reservationList"></div>
  </div>

<script>
  let reservations = [];
  let isAdmin = false;

  function makeReservation() {
    const name = document.getElementById("name").value;
    const room = document.getElementById("room").value;
    const start = document.getElementById("startTime").value;
    const end = document.getElementById("endTime").value;

    if (!name || !room || !start || !end) {
      alert("请填写完整信息！");
      return;
    }

    const status = (room === "学院楼304") ? "待审核" : "已批准";
    reservations.push({name, room, start, end, status});
    renderReservations();
  }

  function renderReservations() {
    const list = document.getElementById("reservationList");
    list.innerHTML = "";
    reservations.forEach((res, index) => {
      const item = document.createElement("div");
      item.className = "item";
      item.innerHTML = `
        <div>
          <strong>${res.name}</strong> | ${res.room}<br/>
          时间: ${res.start} - ${res.end} <br/>
          状态: ${res.status}
        </div>
      `;
      if (isAdmin) {
        const controls = document.createElement("div");
        controls.className = "admin-controls";
        if (res.status === "待审核") {
          const approveBtn = document.createElement("button");
          approveBtn.innerText = "批准";
          approveBtn.onclick = () => { res.status = "已批准"; renderReservations(); };
          controls.appendChild(approveBtn);
        }
        const editBtn = document.createElement("button");
        editBtn.innerText = "调整时间";
        editBtn.onclick = () => {
          const newStart = prompt("输入新的开始时间 (HH:MM)", res.start);
          const newEnd = prompt("输入新的结束时间 (HH:MM)", res.end);
          if (newStart && newEnd) {
            res.start = newStart;
            res.end = newEnd;
            renderReservations();
          }
        };
        controls.appendChild(editBtn);

        const delBtn = document.createElement("button");
        delBtn.className = "delete";
        delBtn.innerText = "删除";
        delBtn.onclick = () => { reservations.splice(index, 1); renderReservations(); };
        controls.appendChild(delBtn);

        item.appendChild(controls);
      }
      list.appendChild(item);
    });
  }

  function toggleAdmin() {
    const email = document.getElementById("adminEmail").value;
    const pwd = document.getElementById("adminPassword").value;
    if (email === "xwjiang@whut.edu.cn" && pwd === "admin123") {
      isAdmin = !isAdmin;
      alert(isAdmin ? "已进入管理员模式" : "已退出管理员模式");
      renderReservations();
    } else {
      alert("管理员账号或密码错误！");
    }
  }
</script>
</body>
</html>
